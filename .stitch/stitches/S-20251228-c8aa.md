+++
id = "S-20251228-c8aa"
title = "Add macOS code signing to GitHub workflows"
status = "open"
created_at = "2025-12-28T18:01:56.234Z"
updated_at = "2025-12-28T18:02:26.653Z"
provenance = "retroactive"
confidence = "high"
tags = [ "ci", "macos", "signing" ]

[scope]
paths = [ ".github/workflows/pr-publish.yml", ".github/workflows/release.yml" ]

[[git.links]]
kind = "commit"
sha = "5c899c4bb801539563b60eb46a3db96b0a5121ca"
+++

## Intent

Add code signing support for macOS binaries in the GitHub Actions workflows. This ensures that distributed macOS binaries are signed with a Developer ID certificate, which:
- Prevents Gatekeeper warnings when users download and run the binary
- Enables future notarization for even smoother user experience
- Establishes trust for the distributed software

## Constraints

- Signing must be optional (only runs when secrets are configured)
- Must work for both PR builds and release builds
- Uses hardened runtime (`--options runtime`) for notarization compatibility
- Must clean up certificate and keychain after signing

## Alternatives

- **Ad-hoc signing**: Simpler but doesn't prevent Gatekeeper warnings
- **Notarization**: More comprehensive but adds complexity; can be added later on top of signing

## Notes

This change was made retroactively (work completed before stitch tracking was initialized).

Required GitHub Secrets:
- `MACOS_CERTIFICATE`: Base64-encoded .p12 certificate
- `MACOS_CERTIFICATE_PASSWORD`: Password for the .p12 file
- `KEYCHAIN_PASSWORD`: Temporary keychain password
